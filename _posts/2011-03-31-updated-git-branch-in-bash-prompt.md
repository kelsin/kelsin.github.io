---
layout: post
title: Updated Git branch in bash prompt
tags:
  - git
---
<p>I had my git branch showing in my bash prompt for a long time. I recently changed my code around to make it much faster (more info below). Here are all the steps to go through.</p><h2>Bash Completion</h2><p>The first step is to get bash completion installed and install the git files for this as well. I use homebrew on the mac to install most open source stuff so you can just install bash-completion from that:</p><div class="CodeRay">  <div class="code"><pre>brew install bash-completion</pre></div></div><p>At the end of the install it tells you to do some things&hellip; Do them:</p><div class="CodeRay">  <div class="code"><pre>Add the following lines to your ~/.bash_profile file:  if [ -f `brew --prefix`/etc/bash_completion ]; then    . `brew --prefix`/etc/bash_completion  fiTo install Homebrew's own completion script:  ln &quot;#{HOMEBREW_PREFIX}/Library/Contributions/brew_bash_completion.sh&quot; &quot;#{etc}/bash_completion.d&quot;</pre></div></div><p>After this you can install git:</p><div class="CodeRay">  <div class="code"><pre>brew install git</pre></div></div><p>and it will install the git prompt functions as well. You can try running <code>__git_ps1</code> from inside a git working directory (in a new shell) to check that it&rsquo;s working correctly</p><h2>Adding branch to prompt</h2><p>If you just want to add the git branch to your prompt you can just use __git_ps1 in your prompt. There&rsquo;s a lot of details in the git completion file. It&rsquo;s located at <code>/usr/local/etc/bash_completion.d/git-completion.bash</code> in a standard install of homebrew.</p><h2>My prompt</h2><p>I wanted my branch to change color based on if I&rsquo;m root or not, if I&rsquo;m on a remote machine or not and I want the branch color to change based on the git status. I did all this via some really messy shell code before. Recently git added support for some git status information in the git_ps1 output (but not using colors) so I rewrote my code using the same methods they had for determining git status. This was all stuff I could have done before but I&rsquo;ve never looked into fancy git commands like diff-index and rev-parse before. My <a href="https://github.com/Kelsin/configs/blob/master/.bash_prompt">current_version</a> of my prompt file is pretty great and ends up much faster.</p>
