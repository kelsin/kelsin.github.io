---
layout: !binary |-
  cG9zdA==
status: !binary |-
  cHVibGlzaA==
published: true
title: Slow Firefox - High Xorg CPU usage - Debian and Ubuntu - SOLVED
author: !binary |-
  S2Vsc2lu
author_login: !binary |-
  YWRtaW4=
author_email: !binary |-
  a2Vsc2luQHZhbGVmb3IuY29t
author_url: !binary |-
  aHR0cDovL2tlbHNpbi5uZXQ=
wordpress_id: 87
wordpress_url: !binary |-
  aHR0cDovL2Jsb2cua2Vsc2luLm5ldC8/cD04Nw==
date: 2009-02-24 11:14:42.000000000 -08:00
categories:
- Computers
tags:
- Ubuntu
- Debian
- Bug
- Intel i810
- Firefox
- Xorg
comments:
- id: 12
  author: MackZ
  author_email: !binary |-
    bWFja3pAd3AucGw=
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wMy0xMCAyMTowNjozNSAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wMy0xMSAwMjowNjozNSAtMDcwMA==
  content: And do you have any problems with mplayer or any player for movies ?
- id: 13
  author: Kelsin
  author_email: !binary |-
    a2Vsc2luQHZhbGVmb3IuY29t
  author_url: !binary |-
    aHR0cDovL2tlbHNpbi5uZXQ=
  date: !binary |-
    MjAwOS0wMy0xMCAyMzowODozMyAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wMy0xMSAwNDowODozMyAtMDcwMA==
  content: Honestly due to it being a work machine I haven't even tried. I think I
    have a video of NIN live on there that I can watch tomorrow. I also don't know
    that I've installed any codecs since switching from Ubuntu to Debian so that might
    be an adventure in and of itself.
- id: 1210
  author: eholliman
  author_email: !binary |-
    ZWhvbGxpbWFuQGdtYWlsLmNvbQ==
  author_url: !binary |-
    aHR0cDovL3d3dy5lZGhvbGxpbWFuLmluZm8=
  date: !binary |-
    MjAwOS0wNS0xMyAxMjo0MjoyNiAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNS0xMyAxNzo0MjoyNiAtMDcwMA==
  content: ! "Thanks loads for this suggestion. I was having problems with both FF
    and xorg using almost every bit of cpu and mem available. After your suggestion
    they are both behaving much better!\r\n\r\nThanks."
- id: 1238
  author: martin
  author_email: !binary |-
    a3JpemFrbUBzZXpuYW0uY3o=
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wNS0xNCAwOTo0NDoyMiAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNS0xNCAxNDo0NDoyMiAtMDcwMA==
  content: It helped me. Thanks a lot :-)
- id: 1656
  author: Dan
  author_email: !binary |-
    ZGJvcmJhQGdtYWlsLmNvbQ==
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wNS0yOSAwODoyMToxMyAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNS0yOSAxMzoyMToxMyAtMDcwMA==
  content: ! "Didn't do much for me =(. I'm having problems mostly with specific sites
    where scrolling becomes nightmarishly slow (nothing special about the sites btw
    - mostly text with no scripts running.) At first I thought it might have been
    the fact that I was using a beta version - but I downgraded and the problem persisted.\r\n\r\nStill
    hunting for a solution."
- id: 1830
  author: Weee
  author_email: !binary |-
    d2F4ZXJ3YXhlckBnbWFpbC5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wNi0wNyAxOTo1NDoyNCAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNi0wOCAwMDo1NDoyNCAtMDcwMA==
  content: Thanks a lot man! This _REALLY_ helped me out. Have been totally frustrated
    the last days because of the latest apt-get updates in debian and this helped
    me out a lot ;) Thanks again!
- id: 1839
  author: Weee
  author_email: !binary |-
    d2F4ZXJ3YXhlckBnbWFpbC5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wNi0wOCAwOToxNjowNiAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNi0wOCAxNDoxNjowNiAtMDcwMA==
  content: ! 'Dan: Try swiftfox in stead of Firefox/Iceweasel. It''s faster.'
- id: 2011
  author: Dudley C.
  author_email: !binary |-
    Z3JhdGVmdWxkdWRlQHNvbWV3aGVyZS5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wNi0yMiAyMDoyNzoyNSAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNi0yMyAwMToyNzoyNSAtMDcwMA==
  content: Thank! Worked for me as well.
- id: 2697
  author: Mathieu
  author_email: !binary |-
    bWF0aGlldWRlcnVpdGVyQGhvdG1haWwuY29t
  author_url: !binary |-
    aHR0cDovL3d3dy5mZWxsaWNodC5ubC8=
  date: !binary |-
    MjAwOS0wNy0yNiAwOTo0MToxOCAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wNy0yNiAxNDo0MToxOCAtMDcwMA==
  content: ! "This worked for me, but when i tried to enable my second screen I still
    got the same problems. Updating (manual) the video drivers did the trick!\r\n\r\nThanks
    for the post."
- id: 3032
  author: jgp
  author_email: !binary |-
    amdwYXdsZXRrb0BnbWFpbC5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAwOS0wOS0xNSAxNTozMzo1NiAtMDcwMA==
  date_gmt: !binary |-
    MjAwOS0wOS0xNSAyMDozMzo1NiAtMDcwMA==
  content: Many thanks. This worked for me.
- id: 3668
  author: Alan
  author_email: !binary |-
    YW9ydGhAdGhlZnJvLm9yZw==
  author_url: !binary |-
    aHR0cDovL2FsYW5pbmtlbnlhLm9yZw==
  date: !binary |-
    MjAwOS0xMS0wMSAxNDo1NjowNiAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMS0wMSAxOTo1NjowNiAtMDgwMA==
  content: ! "Awesome, thanks for the tip.  I'm on Crunchbang 9.04 on a Thinkpad.
    \ I was hating the slow transition between windows, up to like 3 seconds to switch
    windows... in fluxbox.  Seeing Xorg at 90% was killing me. Argh!\r\n\r\nAlan"
- id: 3952
  author: When Gnome and Firefox Are Dead Slow | Cretaceous Labs
  author_email: !binary ""
  author_url: !binary |-
    aHR0cDovL2NyZXRhY2VvdXNsYWJzLmNvbS9ibG9nLzIwMDkvMTEvZ25vbWUt
    ZmlyZWZveC1kZWFkLXNsb3cv
  date: !binary |-
    MjAwOS0xMS0xNCAxNzo1MjozNSAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMS0xNCAyMjo1MjozNSAtMDgwMA==
  content: ! '[...] I stumbled upon this blog post, which purports to have solved
    the problem. I gave it a shot, and holy shit, it [...]'
- id: 3953
  author: Nick Hoffman
  author_email: !binary |-
    bmlja0BkZWFkb3JhbmdlLmNvbQ==
  author_url: !binary |-
    aHR0cDovL2NyZXRhY2VvdXNsYWJzLmNvbS9ibG9n
  date: !binary |-
    MjAwOS0xMS0xNCAxNzo1NTowOSAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMS0xNCAyMjo1NTowOSAtMDgwMA==
  content: ! "Thanks for writing this up, Christopher! I was experiencing the exact
    same problem, and this post solved it.\r\n\r\nI've written my own post about it,
    and given you credit:\r\nhttp://cretaceouslabs.com/blog/2009/11/gnome-firefox-dead-slow/\r\n\r\nCheers,\r\nNick"
- id: 3957
  author: Amir
  author_email: !binary |-
    YW1pckBtb2dyYWJpLm5ldA==
  author_url: !binary ""
  date: !binary |-
    MjAwOS0xMS0xNSAwNDo1OToyMSAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMS0xNSAwOTo1OToyMSAtMDgwMA==
  content: ! "THANK YOU! THANK YOU! THANK YOU! THANK YOU!\r\nI was so upset by this
    problem, nothing worked until I found your post!"
- id: 4698
  author: Fanick
  author_email: !binary |-
    ZmFuaWNrQG1haWxpbmF0b3IuY29t
  author_url: !binary ""
  date: !binary |-
    MjAwOS0xMi0yMiAwOToyNzo1NiAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMi0yMiAxNDoyNzo1NiAtMDgwMA==
  content: Just upgraded to Ubuntu 9.10 Karmic Koala and found xorg eating all my
    crappy CPU. This solution worked for me, thanks man.
- id: 4711
  author: beesblaas
  author_email: !binary |-
    YnJvbWhvZWtAZ21haWwuY29t
  author_url: !binary ""
  date: !binary |-
    MjAwOS0xMi0yMyAxMDozMzoxNCAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMi0yMyAxNTozMzoxNCAtMDgwMA==
  content: ! "It worked for me. Thanks !!\r\nOn some websites I had very slow scrolling,
    jumpy scrolling, or a complete freeze of Firefox for 10sec or so.\r\n\r\nI found
    that switching off Javascript helped, but I still had\r\nproblems.\r\n\r\nexample
    site: (try scrolling fast through the site)\r\nhttp://www.redrok.com/electron.htm\r\n\r\nI
    have Ubuntu 9.10 (karmic koala), firefox 3.5.6, with ATI Radeon card and default
    open-source driver. System Monitor showed high xorg use.\r\n\r\nAfter this fix
    however, I cannot use the System Monitor any more, it builds its window so slow
    it is impossible to load,\r\nyou have to close it. If I disable the fix, System
    Monitor is OK. Why is this?"
- id: 4712
  author: Kelsin
  author_email: !binary |-
    a2Vsc2luQHZhbGVmb3IuY29t
  author_url: !binary |-
    aHR0cDovL2tlbHNpbi5uZXQ=
  date: !binary |-
    MjAwOS0xMi0yMyAxMDozNjo1NiAtMDgwMA==
  date_gmt: !binary |-
    MjAwOS0xMi0yMyAxNTozNjo1NiAtMDgwMA==
  content: The laptop that this fixed helped was an intel video card (driver i810).
    I have no experience with ATI drivers. I would see if the same issues exist with
    the closed source driver?
- id: 4864
  author: Walter
  author_email: !binary |-
    Y29uY2lzZXVzYUB5YWhvby5jb20=
  author_url: !binary |-
    aHR0cDovL3d3dy5zY2hlZHVsZS1teS1lbXBsb3llZXMuY29t
  date: !binary |-
    MjAxMC0wMS0wMiAwMDowNToxMyAtMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wMS0wMiAwNTowNToxMyAtMDgwMA==
  content: Since upgrading to Ubuntu 9.10 Karmic Koala my kids box Xorg has been pegging
    the CPU. Makes the system almost unusable. Tried this, but no difference. I have
    a Nvidia card. Maybe that is the problem.
- id: 4871
  author: Kelsin
  author_email: !binary |-
    a2Vsc2luQHZhbGVmb3IuY29t
  author_url: !binary |-
    aHR0cDovL2tlbHNpbi5uZXQ=
  date: !binary |-
    MjAxMC0wMS0wMiAxMDoxOTozNCAtMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wMS0wMiAxNToxOTozNCAtMDgwMA==
  content: ! "As I said in an above reply, this fix is for a bug in the i810 driver
    (intel graphics cards you find in non-gaming laptop and computers largely built
    into motherboards.)\r\n\r\nIt also was very specific in what was slowed down.
    Not the whole computer but drawing GTK apps specifically. Firefox switching tabs
    was the largest slow down."
- id: 5171
  author: frady
  author_email: !binary |-
    aGFyYXJpYWNoQHlhaG9vLmNvbQ==
  author_url: !binary |-
    aHR0cDovL2Fza2dldGFuc3dlci5jb20=
  date: !binary |-
    MjAxMC0wMS0yMiAxMTo0ODo0NSAtMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wMS0yMiAxNjo0ODo0NSAtMDgwMA==
  content: this works, thank you
- id: 5227
  author: Diego
  author_email: !binary |-
    ZGllZ29ydWJlcnRAaG90bWFpbC5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAxMC0wMS0yNyAxMzo0MjozMyAtMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wMS0yNyAxODo0MjozMyAtMDgwMA==
  content: worked!!!!
- id: 5618
  author: gio
  author_email: !binary |-
    bG9zY2lyb2Njb0BnbWFpbC5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAxMC0wMi0xNiAxMDo1NDozOSAtMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wMi0xNiAxNTo1NDozOSAtMDgwMA==
  content: ! "Thank you, \r\nthis works also for suse linux"
- id: 5797
  author: Kelvalok
  author_email: !binary |-
    a2VsdmFsb2tAZ21haWwuY29t
  author_url: !binary |-
    aHR0cDovL3d3dy5tYWxwb2xvbi5uZXQ=
  date: !binary |-
    MjAxMC0wMi0yNCAwNToxMzo0NSAtMDgwMA==
  date_gmt: !binary |-
    MjAxMC0wMi0yNCAxMDoxMzo0NSAtMDgwMA==
  content: ! "It worked for me (debian stable amd64 + intel driver in xorg). Now iceweasel
    works without this cpu usage.\r\nThanks!\r\nK."
- id: 6009
  author: Randy Wilson
  author_email: !binary |-
    cmFuZHl3aWxzb245OUBnbWFpbC5jb20=
  author_url: !binary ""
  date: !binary |-
    MjAxMC0xMC0wNyAxNDo1OTozOCAtMDcwMA==
  date_gmt: !binary |-
    MjAxMC0xMC0wNyAxOTo1OTozOCAtMDcwMA==
  content: Ubuntu no longer has an xorg.conf.  But today Xorg is taking 50% of my
    CPU, and Firefox is dog slow.  Any futher hints??
---
So the past few days I've noticed Firefox (Iceweasel actually) being incredibly slow. I don't know if it's more than it was on Ubuntu or not, but it was slow. I've also always felt that gtk apps were a bit slow on this machine but never really bothered to understand why.

Today I got fed up with Firefox and decided to go on a Google hunt and solve the problem.
<ol>
	<li>Tried iceweasel (Debian's rebranded Firefox) with -safe-mode. Nothing</li>
	<li>Tried iceweasel with a new profile (mv ~/.mozilla ~/.mozilla-old). Nothing</li>
	<li>Googled bug reports that told me to change about:config settings. Mainly looked like these were for different issues but I tried them anyway.</li>
	<li>Finally I found <a title="Firefox slow bug report" href="https://bugs.launchpad.net/firefox/+bug/38131">this bug</a> report that mentioned changed some AccelMethod lines in xorg. WORKED</li>
</ol>
What worked for me was adding one line to my xorg.conf. The rest is still autoconfigured, I just added the AccelMethod line:

<pre style="color: #bebebe; background-color: #262626; padding: 5px; overflow: auto;">
<span style="color: #40e0d0; font-weight: bold;">Section</span> <span style="color: #87cefa;">"Device"</span>
    <span style="color: #40e0d0; font-weight: bold;">Identifier</span>  <span style="color: #87cefa;">"Configured Video Device"</span>
    <span style="color: #40e0d0; font-weight: bold;">Option</span> <span style="color: #87cefa;">"AccelMethod"</span> <span style="color: #87cefa;">"XAA"</span>
<span style="color: #40e0d0; font-weight: bold;">EndSection</span>
</pre>

My guess is that this problem comes from Xorg's new autoconfig that's been in the most recent versions of Debian and Ubuntu. I think that with the intel driver (i810) it's not able to tell that it should use AccelMethod "XAA". Using XAA could also be a step back in some different ways. Glxgears STILL only shows 170 fps for me (I know, this is pretty bad, but it's my work machine), but all GTK apps are so much faster I feel like I'm on a new computer. Xmonad finally feels super speedy (as it should!)

Again this worked for me, and I have NO idea what else this change means. Try it at your own risk if you're on a Intel card with a weird, very-slow Firefox.
